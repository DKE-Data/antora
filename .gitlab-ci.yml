image: node:8
before_script:
- npm install -g yarn
stages:
- setup
- verify
yarn-install:
  stage: setup
  script:
  - yarn --cache-folder=.yarn-cache install
  cache:
    paths:
    - node_modules/
    - .yarn-cache/
lint:
  stage: verify
  cache:
    policy: pull
    paths:
    - node_modules/
  script: node_modules/.bin/gulp lint
test:
  stage: verify
  cache:
    policy: pull
    paths:
    - node_modules/
  script: yarn test
  artifacts:
    paths:
    - coverage
